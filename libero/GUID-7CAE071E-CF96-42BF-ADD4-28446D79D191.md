# Interrupts

**Parent topic:**[Simulation Flow](GUID-C6E6D8E0-C726-46F1-ADEA-D21BA9D5101E.md)

## F2H Interrupts

The MSS simulation model acknowledges assertion of the F2H interrupts. There are 64 F2H interrupt ports. When the MSS receives a valid active-high interrupt, it acknowledges them by printing a message as shown in the following code block.

```
# INFO : F2H_INTERRUPT[0] is asserted
# INFO : F2H_INTERRUPT[1] is asserted
# INFO : F2H_INTERRUPT[2] is asserted
# INFO : F2H_INTERRUPT[3] is asserted
# INFO : F2H_INTERRUPT[4] is asserted
# INFO : F2H_INTERRUPT[5] is asserted
# INFO : F2H_INTERRUPT[6] is asserted
# INFO : F2H_INTERRUPT[7] is asserted
# INFO : F2H_INTERRUPT[8] is asserted
# INFO : F2H_INTERRUPT[9] is asserted
# INFO : F2H_INTERRUPT[10] is asserted
```

The interrupt inputs should be high for one MSS clock; otherwise, the MSS model rejects the interrupt for being too low and prints a message as shown in the following code block.

```
# ERROR : F2H_INTERRUPT[0] must stay high for at least one MSS clock cycle
# ERROR : F2H_INTERRUPT[1] must stay high for at least one MSS clock cycle
# ERROR : F2H_INTERRUPT[2] must stay high for at least one MSS clock cycle
# ERROR : F2H_INTERRUPT[3] must stay high for at least one MSS clock cycle
# ERROR : F2H_INTERRUPT[4] must stay high for at least one MSS clock cycle
# ERROR : F2H_INTERRUPT[5] must stay high for at least one MSS clock cycle
# ERROR : F2H_INTERRUPT[6] must stay high for at least one MSS clock cycle
# ERROR : F2H_INTERRUPT[7] must stay high for at least one MSS clock cycle
# ERROR : F2H_INTERRUPT[8] must stay high for at least one MSS clock cycle
# ERROR : F2H_INTERRUPT[9] must stay high for at least one MSS clock cycle
```

## H2F Interrupts

The MSS simulation model allows you to use text files to set and clear H2F interrupts. To do this, add the following command in the `run.do` file:

```
vsim -L polarfire -L presynth -t 1ps -g H2F_MEMFILE=(path)/*.txt presynth.tb
```

For example:

```
vsim -L polarfire -L presynth -t 1ps -g H2F_MEMFILE=E:/mss_sim/h2f_sim.txt presynth.tb
```

There are 16 H2F interrupts. The following table lists their allocation in MSS.

|H2F Line|Group|
|--------|-----|
|0|GPIO|
|1|MMUART, SPI, CAN|
|2|I2C|
|3|MAC0|
|4|MAC1|
|5|WATCHDOGS|
|6|Maintenance|
|7|SCB|
|8|PolarFire®C-Message|
|9|DDRC|
|10|PolarFireC-DEVRST|
|11|RTC/USOC|
|12|TIMER|
|13|ENVM, QSPI|
|14|USB|
|15|MMC/SDIO|

Use text file based entries to set and clear an interrupt, see the following example.

```
Wait Time        (Time to wait in number MSS PLL clock cycles, Hex)
Interrupt Value  (16-bit value, Hex)
Wait time        (Time to wait in number MSS PLL clock cycles, Hex)
Interrupt Value  (16-bit value, Hex)
...
```

Example:

```
100          (Wait for 100 (256 in DEC) MSS PLL clock cycles)
FFFF         (Set all 16 interrupts)
1000         (Wait for 1000 (4096 in DEC) MSS clock cycles)
0000         (Clear all 16 interrupts)
...
```

The H2F interrupts can be cleared by clearing an interrupt register bit in the corresponding peripheral. These AXI transactions can be generated by an Initiator in FPGA fabric.

|H2F Line|Group|AXI Address and Data Bits to Clear an Interrupt|
|--------|-----|-----------------------------------------------|
|0|GPIO|Reg|**PolarFire SoC\_mss\_regmap:GPIO:INTR**|
|Physical Address|0x2012 00800x2012 10800x2012 20800x2812 00800x2812 10800x2812 2080|
|Data|Bit-0: To clear an interrupt, write the bit with 1.|
|1|MMUART|Reg|**PolarFire SoC\_mss\_regmap:MMUART:IIM**|
|Physical Address|0x2000 00280x2010 00280x2010 20280x2010 40280x2010 60280x2800 00280x2810 00280x2810 20280x2810 40280x2810 6028|
|Data|Reading the IIM register clears this interrupt.|
|Reg|**PolarFire SoC\_mss\_regmap:MMUART:MM2**|
|Physical Address|0x2000 00380x2010 00380x2010 20380x2010 40380x2010 60380x2800 00380x2810 00380x2810 20380x2810 40380x2810 6038|
|Data|Reading the MM2 clears the interrupt.|
|1|MMUART|Reg|**PolarFire SoC\_mss\_regmap:MMUART:RTO**|
|Physical Address|0x2000 004C0x2010 004C0x2010 204C0x2010 404C0x2010 604C0x2800 004C0x2810 004C0x2810 204C0x2810 404C0x2810 604C|
|Data|Writing the RTO register clears this interrupt.|
|1|SPI|Reg|**PolarFire SoC\_mss\_regmap:SPI:INT\_CLEAR**|
|Physical Address|0x2010 800C0x2010 900C0x2810 800C0x2810 900C|
|Data|Bit-5: Write 1 to clear the interrupt.Bit-4: Write 1 to clear the interrupt.|
|1|CAN|—|Not supported.|
|2|I2C|—|Not supported.|
|3|MAC0|—|Not supported.|
|4|MAC1|—|Not supported.|
|5|WATCHDOGS|—|Not supported.|
|6|Maintenance|—|Not supported.|
|7|SCB|—|Not supported.|
|8|PolarFireC-Message|—|Not supported.|
|9|DDRC|—|Not supported.|
|10|PolarFireC-DEVRST|—|Not supported.|
|11|RTC/USOC|—|Not supported.|
|12|TIMER|—|Not supported.|
|13|ENVM,QSPI|—|Not supported.|
|14|USB|—|Not supported.|
|15|MMC/SDIO|—|Not supported.|

